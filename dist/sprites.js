(()=>{function t(t){return new Promise((e=>setTimeout(e,t)))}class e{constructor(t,e,i){this.imgSrc=t,this.width=e,this.height=i,this.sx=0,this.sy=0,this.dx=0,this.dy=0,this.image=new Image,this.image.src=t,this.animating=!1}render(t){this.animating&&null!=this.animating&&this.nextFrame(),t.getContext("2d").drawImage(this.image,this.sx,this.sy,this.width,this.height,this.dx,this.dy,this.width,this.height)}setAnimation(t,e=null,i=!0){this.animation=t,e&&(this.animation.onComplete=e),this.animating=i}nextFrame(){let t=this.animation.nextFrame();this.sx=t.x,this.sy=t.y}}class i{constructor(t){this.xStart=t.xStart,this.yOffset=t.yOffset,this.nextSpriteX=t.nextSpriteX,this.xEnd=t.xEnd,this.fpsBuffer=t.fpsBuffer,this.buffer=0,this.x=t.xStart,this.y=t.yLine,this.onComplete=t.onComplete}nextFrame(){let t={x:this.x,y:this.yOffset};return this.buffer<=this.fpsBuffer?(this.buffer++,t):(this.x+=this.nextSpriteX,(this.xEnd<0&&this.x<=this.xEnd||this.x>=this.xEnd)&&this.reset(),this.buffer=0,t)}reset(){this.x=this.xStart,this.onComplete&&this.onComplete()}}class s{constructor(){this.sprite=new e("../dist/sprites/explosion-edit.png",165,165)}render(t){this.sprite.animation&&(this.sprite.nextFrame(),this.sprite.render(t))}async explode(){this.sprite.setAnimation(new i({xStart:0,xEnd:990,nextSpriteX:165,yOffset:0,fpsBuffer:3,onComplete:()=>{this.sprite.setAnimation(null)}}))}}var n=new class{constructor(t=[]){this.canvas=document.createElement("canvas"),this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.canvas.id="randomly-generated-i-guess",this.canvas.style.position="fixed",this.canvas.style.top=0,this.canvas.style.right=0,this.canvas.style.bottom=0,this.canvas.style.left=0,this.canvas.style.zIndex=9e3,this.canvas.style.pointerEvents="none",this.sprites=t}addSprite(t){this.sprites.push(t)}attach(t){t?t.appendChild(this.canvas):console.error("given element was null")}render(){this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height),this.sprites.forEach((t=>{t.render(this.canvas)}))}async loop(){for(;;)this.render(),await t(25)}get(){return this.canvas}clear(){this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height)}};let a=new class{constructor(){this.sprite=new e("../dist/sprites/cheems.png",205,137),this.animations={idle:new i({xStart:0,xEnd:205,nextSpriteX:0,yOffset:0,fpsBuffer:7}),bonk:new i({xStart:205,xEnd:411,nextSpriteX:205,yOffset:0,fpsBuffer:2,onComplete:()=>{this.sprite.animating=!1}})},this.sprite.setAnimation(this.animations.idle)}render(t){this.sprite.animation&&this.sprite.render(t)}bonk(){new Audio("../dist/sounds/bonk.ogg").play(),this.sprite.setAnimation(this.animations.bonk,(()=>{this.sprite.setAnimation(null)}))}};n.addSprite(a);var r,h=new class{constructor(){this.sprite=new e("../dist/sprites/jotaro_new.png",97,97),this.animations={idle:new i({xStart:873,xEnd:1358,nextSpriteX:97,yOffset:0,fpsBuffer:7}),run:new i({xStart:0,xEnd:776,nextSpriteX:97,yOffset:0,fpsBuffer:1}),punch1:new i({xStart:1455,xEnd:1649,nextSpriteX:97,yOffset:0,fpsBuffer:2,onComplete:()=>{this.idle()}})},this.sprite.setAnimation(this.animations.idle)}render(t){this.sprite.animation&&this.sprite.render(t)}run(){this.sprite.setAnimation(this.animations.run)}idle(){this.sprite.setAnimation(this.animations.idle)}punch(t=null){this.sprite.setAnimation(this.animations.punch1,t)}async bonkImage(e,i){new Audio("../dist/sounds/yareyaredaze.ogg").play(),await t(25),this.run();let a=e.x-this.sprite.dx-.1*e.x;for(let e=0;e<a;e+=10)this.sprite.dx=e,await t(25);this.punch((()=>{}));var r=new Audio("../dist/sounds/ORA.ogg");r.addEventListener("ended",(()=>{let t=new s;n.addSprite(t),t.sprite.dx=e.x,t.sprite.dy=e.y,t.explode().then((()=>{new Audio("../dist/sounds/bonk.ogg").play(),this.idle(),e.remove()}))})),r.play()}};n.addSprite(h),document.addEventListener("DOMContentLoaded",(function(){var t;console.log("やれやれだぜ。"),console.log(r),r=document.getElementById("cat"),n.attach(document.body),n.loop(),h.idle(),r=document.getElementById("cat"),(t=r).style.cursor="pointer",t.addEventListener("click",(e=>{a.sprite.dx=t.x-.15*t.x,a.sprite.dy=t.y-.2*t.y,a.bonk();let i=new s;n.addSprite(i),i.sprite.dx=t.x,i.sprite.dy=t.y,i.explode().then(setTimeout((()=>2),200))})),console.log(r)}))})();