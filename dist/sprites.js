(()=>{function t(t){return new Promise((s=>setTimeout(s,t)))}class s{constructor(t,s){this.imgSrc=t,this.dimensions=s,this.sx=0,this.sy=0,this.dx=0,this.dy=0,this.image=new Image,this.image.src=t}render(t){t.getContext("2d").drawImage(this.image,this.sx,this.sy,this.dimensions.width,this.dimensions.height,this.dx,this.dy,this.dimensions.width,this.dimensions.height)}setAnimation(t){this.animation=t}nextFrame(){let t=this.animation.nextFrame();this.sx=t.x,this.sy=t.y}}class i{constructor(t){this.xStart=t.xStart,this.yOffset=t.yOffset,this.nextSpriteX=t.nextSpriteX,this.xEnd=t.xEnd,this.fpsBuffer=t.fpsBuffer,this.buffer=0,this.x=t.xStart,this.y=t.yLine,this.loop=t.loop}nextFrame(){let t={x:this.x,y:this.yOffset};return this.buffer<=this.fpsBuffer?(this.buffer++,t):(this.x+=this.nextSpriteX,(this.xEnd<0&&this.x<=this.xEnd||this.x>=this.xEnd)&&(this.x=this.xStart),this.buffer=0,t)}}var e,n=new class{constructor(t=[]){this.canvas=document.createElement("canvas"),this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.canvas.id="randomly-generated-i-guess",this.canvas.style.position="fixed",this.canvas.style.top=0,this.canvas.style.right=0,this.canvas.style.bottom=0,this.canvas.style.left=0,this.canvas.style.zIndex=9e3,this.sprites=t}addSprite(t){this.sprites.push(t)}attach(t){t?t.appendChild(this.canvas):console.error("given element was null")}render(){this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height),this.sprites.forEach((t=>{t.render(this.canvas)}))}async loop(){for(;;)this.render(),await t(25)}get(){return this.canvas}clear(){this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height)}},a=new class{constructor(){this.sprite=new s(browser.extension.getURL("sprites/jotaro_new.png"),{width:97,height:97}),this.animations={idle:new i({xStart:873,xEnd:1358,nextSpriteX:97,yOffset:0,fpsBuffer:7,loop:!0}),run:new i({xStart:0,xEnd:776,nextSpriteX:97,yOffset:0,fpsBuffer:1,loop:!0}),punch1:new i({xStart:1455,xEnd:1649,nextSpriteX:97,yOffset:0,fpsBuffer:2,loop:!1})},this.sprite.setAnimation(this.animations.idle)}render(t){this.sprite.animation&&(this.sprite.nextFrame(),this.sprite.render(t))}run(){this.sprite.setAnimation(this.animations.run)}idle(){this.sprite.setAnimation(this.animations.idle)}async punch(s=!1){this.sprite.setAnimation(this.animations.punch1),s||(await t(200),this.idle())}async bonkImage(s){this.run();let i=s.x-this.sprite.dx-.1*s.x;for(let s=0;s<i;s+=10)this.sprite.dx=s,await t(25);alert("ORA ORA ORA ORA ORA"),this.punch(!0),await t(100),s.style.backgroundImage=new URL(s.src),s.style.boxShadow="inset 0 0 99999px rgba(0, 120, 255, 0.5);"}};n.addSprite(a),document.addEventListener("DOMContentLoaded",(function(){console.log("やれやれだぜ。"),console.log(e),e=document.getElementById("cat"),n.attach(document.body),n.loop(),a.idle(),e=document.getElementsByClassName("mzp-c-split-media-asset")[1],a.bonkImage(e)}))})();