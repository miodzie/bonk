(()=>{function t(t){return new Promise((e=>setTimeout(e,t)))}class e{constructor(t,e,s){this.imgSrc=t,this.width=e,this.height=s,this.sx=0,this.sy=0,this.dx=0,this.dy=0,this.image=new Image,this.image.src=t,this.animating=!1}render(t){this.animating&&null!=this.animating&&this.nextFrame(),t.getContext("2d").drawImage(this.image,this.sx,this.sy,this.width,this.height,this.dx,this.dy,this.width,this.height)}setAnimation(t,e=null,s=!0){this.animation=t,e&&(this.animation.onComplete=e),this.animating=s}nextFrame(){let t=this.animation.nextFrame();this.sx=t.x,this.sy=t.y}}class s{constructor(t){this.xStart=t.xStart,this.yOffset=t.yOffset,this.nextSpriteX=t.nextSpriteX,this.xEnd=t.xEnd,this.fpsBuffer=t.fpsBuffer,this.buffer=0,this.x=t.xStart,this.y=t.yLine,this.onComplete=t.onComplete}nextFrame(){let t={x:this.x,y:this.yOffset};return this.buffer<=this.fpsBuffer?(this.buffer++,t):(this.x+=this.nextSpriteX,(this.xEnd<0&&this.x<=this.xEnd||this.x>=this.xEnd)&&this.reset(),this.buffer=0,t)}reset(){this.x=this.xStart,this.onComplete&&this.onComplete()}}class i{constructor(){this.sprite=new e("../dist/sprites/explosion-edit.png",165,165)}render(t){this.sprite.animation&&(this.sprite.nextFrame(),this.sprite.render(t))}async explode(){this.sprite.setAnimation(new s({xStart:0,xEnd:990,nextSpriteX:165,yOffset:0,fpsBuffer:3,onComplete:()=>{this.sprite.setAnimation(null)}}))}}var n,a=new class{constructor(t=[]){this.canvas=document.createElement("canvas"),this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.canvas.id="randomly-generated-i-guess",this.canvas.style.position="fixed",this.canvas.style.top=0,this.canvas.style.right=0,this.canvas.style.bottom=0,this.canvas.style.left=0,this.canvas.style.zIndex=9e3,this.canvas.style.pointerEvents="none",this.sprites=t}addSprite(t){this.sprites.push(t)}attach(t){t?t.appendChild(this.canvas):console.error("given element was null")}render(){this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height),this.sprites.forEach((t=>{t.render(this.canvas)}))}async loop(){for(;;)this.render(),await t(25)}get(){return this.canvas}clear(){this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height)}},h=new class{constructor(){this.sprite=new e("../dist/sprites/jotaro_new.png",97,97),this.animations={idle:new s({xStart:873,xEnd:1358,nextSpriteX:97,yOffset:0,fpsBuffer:7}),run:new s({xStart:0,xEnd:776,nextSpriteX:97,yOffset:0,fpsBuffer:1}),punch1:new s({xStart:1455,xEnd:1649,nextSpriteX:97,yOffset:0,fpsBuffer:2,onComplete:()=>{this.idle()}})},this.sprite.setAnimation(this.animations.idle)}render(t){this.sprite.animation&&this.sprite.render(t)}run(){this.sprite.setAnimation(this.animations.run)}idle(){this.sprite.setAnimation(this.animations.idle)}punch(t=null){this.sprite.setAnimation(this.animations.punch1,t)}async bonkImage(e,s){new Audio("../dist/sounds/yareyaredaze.ogg").play(),await t(25),this.run();let n=e.x-this.sprite.dx-.1*e.x;for(let e=0;e<n;e+=10)this.sprite.dx=e,await t(25);this.punch((()=>{}));var h=new Audio("../dist/sounds/ORA.ogg");h.addEventListener("ended",(()=>{let t=new i;a.addSprite(t),t.sprite.dx=e.x,t.sprite.dy=e.y,t.explode().then((()=>{new Audio("../dist/sounds/bonk.ogg").play(),this.idle(),e.remove()}))})),h.play()}};a.addSprite(h),document.addEventListener("DOMContentLoaded",(function(){var t;console.log("やれやれだぜ。"),console.log(n),n=document.getElementById("cat"),a.attach(document.body),a.loop(),h.idle(),n=document.getElementById("cat"),(t=n).style.cursor="pointer",t.addEventListener("click",(e=>{h.bonkImage(t)})),console.log(n)}))})();